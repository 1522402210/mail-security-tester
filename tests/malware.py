# Malware recognition tests

from email.mime.application import MIMEApplication
from .base import MailAttachmentTestBase

class EICARMalwareTest(MailAttachmentTestBase):
    active = True
    identifier = "eicar"
    name = "EICAR Test File"
    description = "Attach EICAR test file"
    subject = "EICAR - {}"
    extensions = ("com", "exe", "txt", "html")
    file_name = "eicar.{}"
    file_content = "X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*"

    def generateAttachments(self):
        for extension in self.extensions:
            attachment = MIMEApplication(self.file_content)
            attachment.add_header("Content-Disposition", "attachment", filename=self.file_name.format(extension))
            yield extension, attachment
